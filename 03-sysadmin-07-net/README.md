# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?  

Ответ:
Linux  
`ip link show`  



`ip -c -br link`  



`ifconfig -a`  



Windows  
`ipconfig /all`



---

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?  

Ответ:  
Протокол LLDP (Link Layer Discovery Protocol)  
Необходимо установить пакет `lldpd`  
`sudo apt install lldpd`  
Команда `lldpctl`  
Пример:  
`lldpctl -v`  
`lldpcli show interfaces`  
`lldpcli show neigh`  



---

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.  

Ответ:  
Технология VLAN (Virtual LAN).

`sudo nano /etc/netplan/01-netcfg.yaml`  
Добовляем в файл конфигурации `netplan` по пути `/etc/netplan/01-netcfg.yaml` содержимой:  

```
network:
  ethernets:
    eth0:
     dhcp4: true
  version: 2
  vlans:
    vlan77:
     id: 77
     link: eth0
     dhcp4: no
     addresses:
       - 192.168.77.7/24
```
Примененяем конфигурацию:  
`sudo netplan apply`  
Проверяем:  


---

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.  

Ответ:

Bonding - Агрегация сетевых интерфейсов

Типы агрегации bonding:  
 - `Mode-0(balance-rr)` - Пакеты отправляются последовательно, начиная с первого доступного интерфейса и заканчивая последним. Эта политика применяется для балансировки нагрузки и отказоустойчивости.  
 - `Mode-1(active-backup)` - Только один сетевой интерфейс из объединённых будет активным. Другой интерфейс может стать активным, только в том случае, когда упадёт текущий активный интерфейс. Эта политика применяется для отказоустойчивости.   
 - `Mode-2(balance-xor)` - Передача пакетов распределяется по типу входящего и исходящего трафика по формуле `((MAC src) XOR (MAC dest)) % число интерфейсов`. Режим дает балансировку нагрузки и отказоустойчивость.  
 - `Mode-3(broadcast)` - Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость.   
 - `Mode-4(802.3ad)` - Политика агрегирования каналов по стандарту IEEE 802.3ad. Создаются агрегированные группы сетевых карт с одинаковой скоростью и дуплексом. При таком объединении передача задействует все каналы в активной агрегации, согласно стандарту IEEE 802.3ad. Выбор через какой интерфейс отправлять пакет определяется политикой по умолчанию XOR политика.   
 - `Mode-5(balance-tlb)` - Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса.   
 - `Mode-6(balance-alb)` - Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки нагрузки чем Mode-5). Обеспечивается балансировку нагрузки как исходящего так и входящего трафика.    


Пример конфигураций:  

 * `Mode-1(active-backup)`

```
 network:
   version: 2
   renderer: networkd
   ethernets:
     eth0:
       dhcp4: no 
       optional: true
     eth1: 
       dhcp4: no 
       optional: true
   bonds:
     bond0: 
       dhcp4: yes 
       interfaces:
         - eth0
         - eth1
       parameters:
         mode: active-backup
         primary: eth0
         mii-monitor-interval: 2
```
 * `Mode-6(balance-alb)`

```
bonds:
     bond0: 
       dhcp4: yes 
       interfaces:
         - eth0
         - eth1
       parameters:
         mode: balance-alb
         mii-monitor-interval: 2
```

---

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.  

Ответ:

 - 6 используемых адресов для хостов в маске /29, 1 адрес сети и 1 широковещательный адрес.
 - Сеть с маской /24 можно разбить на 32 подсети с маской /29  
  
`ipcalc -b 10.10.10.0/29`  
`ipcalc 10.10.10.0 255.255.255.0 255.255.255.248`



---

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.  

Ответ:  
Можно использовать адреса из сети Carrier-Grade NAT `100.64.0.0`  
Маска `/26` `255.255.255.192` на назначаемых 62 хоста  
`100.64.0.0/26`  



---

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?  

Ответ:

Проверить таблицу можно так:  
 - Linux: `ip neigh`, `arp -n`  
 - Windows: `arp -a`  

Очистить кеш так:  
 - Linux: `ip neigh flush`    
 - Windows: `arp -d`  

Удалить один IP так:  
 - Linux: `ip neigh delete <IP> dev <INTERFACE>, arp -d <IP>`  
 - Windows: `arp -d <IP>`  
  
---